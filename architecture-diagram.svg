<svg viewBox="0 0 1200 900" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="1200" height="900" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="600" y="40" font-family="Arial, sans-serif" font-size="28" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    USCCB Data Extraction Pipeline Architecture
  </text>
  
  <!-- Data Sources Section -->
  <g id="data-sources">
    <rect x="40" y="80" width="200" height="280" rx="10" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
    <text x="140" y="110" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle" fill="#2e7d32">Data Sources</text>
    
    <rect x="60" y="130" width="160" height="40" rx="5" fill="#ffffff" stroke="#81c784" stroke-width="1"/>
    <text x="140" y="155" font-family="Arial" font-size="12" text-anchor="middle">USCCB Website</text>
    
    <rect x="60" y="180" width="160" height="40" rx="5" fill="#ffffff" stroke="#81c784" stroke-width="1"/>
    <text x="140" y="205" font-family="Arial" font-size="12" text-anchor="middle">Diocese Websites</text>
    
    <rect x="60" y="230" width="160" height="40" rx="5" fill="#ffffff" stroke="#81c784" stroke-width="1"/>
    <text x="140" y="255" font-family="Arial" font-size="12" text-anchor="middle">Parish Websites</text>
  </g>
  
  <!-- Pipeline Steps -->
  <g id="pipeline">
    <!-- Step 1: Extract Dioceses -->
    <g id="step1">
      <rect x="320" y="80" width="180" height="120" rx="10" fill="#fff3e0" stroke="#ff9800" stroke-width="2"/>
      <text x="410" y="105" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#e65100">Step 1: Extract Dioceses</text>
      <text x="410" y="125" font-family="Arial" font-size="11" text-anchor="middle">extract_dioceses.py</text>
      <text x="410" y="145" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Scrapes USCCB site</text>
      <text x="410" y="160" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Gets diocese info</text>
      <text x="410" y="175" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Stores in Dioceses table</text>
    </g>
    
    <!-- Step 2: Find Parish Directories -->
    <g id="step2">
      <rect x="320" y="230" width="180" height="120" rx="10" fill="#fce4ec" stroke="#e91e63" stroke-width="2"/>
      <text x="410" y="255" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#880e4f">Step 2: Find Directories</text>
      <text x="410" y="275" font-family="Arial" font-size="11" text-anchor="middle">find_parishes.py</text>
      <text x="410" y="295" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ AI-powered detection</text>
      <text x="410" y="310" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Searches for parish URLs</text>
      <text x="410" y="325" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Uses Gemini AI</text>
    </g>
    
    <!-- Step 3: Extract Parishes -->
    <g id="step3">
      <rect x="320" y="380" width="180" height="120" rx="10" fill="#e3f2fd" stroke="#2196f3" stroke-width="2"/>
      <text x="410" y="405" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#0d47a1">Step 3: Extract Parishes</text>
      <text x="410" y="425" font-family="Arial" font-size="11" text-anchor="middle">extract_parishes.py</text>
      <text x="410" y="445" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Pattern detection</text>
      <text x="410" y="460" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Multi-platform support</text>
      <text x="410" y="475" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Detail page navigation</text>
    </g>
    
    <!-- Step 4: Extract Schedules -->
    <g id="step4">
      <rect x="320" y="530" width="180" height="120" rx="10" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2"/>
      <text x="410" y="555" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#4a148c">Step 4: Extract Schedules</text>
      <text x="410" y="575" font-family="Arial" font-size="11" text-anchor="middle">extract_schedule.py</text>
      <text x="410" y="595" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Visits parish sites</text>
      <text x="410" y="610" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Finds mass times</text>
      <text x="410" y="625" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Adoration/Reconciliation</text>
    </g>
  </g>
  
  <!-- Extractors Box -->
  <g id="extractors">
    <rect x="550" y="320" width="200" height="240" rx="10" fill="#f5f5f5" stroke="#9e9e9e" stroke-width="2" stroke-dasharray="5,5"/>
    <text x="650" y="345" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#424242">Parish Extractors</text>
    <text x="650" y="365" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">(parish_extractors.py)</text>
    
    <rect x="570" y="380" width="160" height="25" rx="5" fill="#e1f5fe" stroke="#0288d1" stroke-width="1"/>
    <text x="650" y="397" font-family="Arial" font-size="10" text-anchor="middle">Diocese Card Extractor</text>
    
    <rect x="570" y="415" width="160" height="25" rx="5" fill="#e1f5fe" stroke="#0288d1" stroke-width="1"/>
    <text x="650" y="432" font-family="Arial" font-size="10" text-anchor="middle">Parish Finder Extractor</text>
    
    <rect x="570" y="450" width="160" height="25" rx="5" fill="#e1f5fe" stroke="#0288d1" stroke-width="1"/>
    <text x="650" y="467" font-family="Arial" font-size="10" text-anchor="middle">Table Extractor</text>
    
    <rect x="570" y="485" width="160" height="25" rx="5" fill="#e1f5fe" stroke="#0288d1" stroke-width="1"/>
    <text x="650" y="502" font-family="Arial" font-size="10" text-anchor="middle">Interactive Map Extractor</text>
    
    <rect x="570" y="520" width="160" height="25" rx="5" fill="#e1f5fe" stroke="#0288d1" stroke-width="1"/>
    <text x="650" y="537" font-family="Arial" font-size="10" text-anchor="middle">Generic Extractor</text>
  </g>
  
  <!-- Technologies -->
  <g id="technologies">
    <rect x="550" y="80" width="200" height="200" rx="10" fill="#fff8e1" stroke="#ffc107" stroke-width="2"/>
    <text x="650" y="105" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#f57c00">Core Technologies</text>
    
    <text x="650" y="130" font-family="Arial" font-size="11" text-anchor="middle" fill="#666">ğŸŒ Selenium WebDriver</text>
    <text x="650" y="150" font-family="Arial" font-size="11" text-anchor="middle" fill="#666">ğŸ¤– Google Gemini AI</text>
    <text x="650" y="170" font-family="Arial" font-size="11" text-anchor="middle" fill="#666">ğŸ” BeautifulSoup4</text>
    <text x="650" y="190" font-family="Arial" font-size="11" text-anchor="middle" fill="#666">ğŸ Python + Pandas</text>
    <text x="650" y="210" font-family="Arial" font-size="11" text-anchor="middle" fill="#666">ğŸ”„ Tenacity (Retry Logic)</text>
    <text x="650" y="230" font-family="Arial" font-size="11" text-anchor="middle" fill="#666">ğŸ” Google Search API</text>
    <text x="650" y="250" font-family="Arial" font-size="11" text-anchor="middle" fill="#666">ğŸŒ Requests Library</text>
  </g>
  
  <!-- Database -->
  <g id="database">
    <rect x="820" y="80" width="340" height="520" rx="10" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
    <text x="990" y="110" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle" fill="#2e7d32">Supabase Database</text>
    <text x="990" y="130" font-family="Arial" font-size="11" text-anchor="middle" fill="#666">(PostgreSQL)</text>
    
    <!-- Dioceses Table -->
    <rect x="850" y="150" width="280" height="90" rx="5" fill="#ffffff" stroke="#81c784" stroke-width="1"/>
    <text x="990" y="170" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">ğŸ“Š Dioceses Table</text>
    <text x="990" y="190" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Diocese names</text>
    <text x="990" y="205" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Addresses</text>
    <text x="990" y="220" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Official websites</text>
    
    <!-- DiocesesParishDirectory Table -->
    <rect x="850" y="260" width="280" height="90" rx="5" fill="#ffffff" stroke="#81c784" stroke-width="1"/>
    <text x="990" y="280" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">ğŸ”— DiocesesParishDirectory</text>
    <text x="990" y="300" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Diocese URLs</text>
    <text x="990" y="315" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Parish directory URLs</text>
    <text x="990" y="330" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Detection method & status</text>
    
    <!-- Parishes Table -->
    <rect x="850" y="370" width="280" height="105" rx="5" fill="#ffffff" stroke="#81c784" stroke-width="1"/>
    <text x="990" y="390" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">â›ª Parishes Table</text>
    <text x="990" y="410" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Names, addresses, contacts</text>
    <text x="990" y="425" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Websites, coordinates</text>
    <text x="990" y="440" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Clergy info, service times</text>
    <text x="990" y="455" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Extraction metadata</text>
    
    <!-- ParishSchedules Table -->
    <rect x="850" y="495" width="280" height="85" rx="5" fill="#ffffff" stroke="#81c784" stroke-width="1"/>
    <text x="990" y="515" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">ğŸ“… ParishSchedules Table</text>
    <text x="990" y="535" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Adoration schedules</text>
    <text x="990" y="550" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Reconciliation times</text>
    <text x="990" y="565" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Mass schedules</text>
  </g>
  
  <!-- Orchestration -->
  <g id="orchestration">
    <rect x="40" y="700" width="460" height="140" rx="10" fill="#e1bee7" stroke="#7b1fa2" stroke-width="2"/>
    <text x="270" y="730" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle" fill="#4a148c">Pipeline Orchestration</text>
    
    <rect x="60" y="750" width="180" height="70" rx="5" fill="#ffffff" stroke="#ba68c8" stroke-width="1"/>
    <text x="150" y="770" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">ğŸš€ run_pipeline.py</text>
    <text x="150" y="790" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Orchestrates all steps</text>
    <text x="150" y="805" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Configurable limits</text>
    
    <rect x="260" y="750" width="220" height="70" rx="5" fill="#ffffff" stroke="#ba68c8" stroke-width="1"/>
    <text x="370" y="770" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">âš™ï¸ Configuration</text>
    <text x="370" y="790" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ config.py (API keys, defaults)</text>
    <text x="370" y="805" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ .env file (sensitive data)</text>
  </g>
  
  <!-- Reporting -->
  <g id="reporting">
    <rect x="550" y="700" width="200" height="140" rx="10" fill="#c8e6c9" stroke="#388e3c" stroke-width="2"/>
    <text x="650" y="730" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle" fill="#1b5e20">Reporting</text>
    
    <rect x="570" y="750" width="160" height="70" rx="5" fill="#ffffff" stroke="#66bb6a" stroke-width="1"/>
    <text x="650" y="770" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">ğŸ“ˆ report_statistics.py</text>
    <text x="650" y="790" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Database statistics</text>
    <text x="650" y="805" font-family="Arial" font-size="10" text-anchor="middle" fill="#666">â€¢ Time-series charts</text>
  </g>
  
  <!-- Flow Arrows -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#666"/>
    </marker>
  </defs>
  
  <!-- Data flow arrows -->
  <path d="M 240 170 L 315 140" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <path d="M 500 140 L 545 140" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <path d="M 410 200 L 410 225" stroke="#ff9800" stroke-width="2" marker-end="url(#arrowhead)"/>
  <path d="M 410 350 L 410 375" stroke="#e91e63" stroke-width="2" marker-end="url(#arrowhead)"/>
  <path d="M 500 440 L 545 440" stroke="#2196f3" stroke-width="2" marker-end="url(#arrowhead)"/>
  <path d="M 410 500 L 410 525" stroke="#2196f3" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- To database arrows -->
  <path d="M 750 140 L 815 140" stroke="#4caf50" stroke-width="2" marker-end="url(#arrowhead)"/>
  <path d="M 500 140 L 815 195" stroke="#ff9800" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  <path d="M 500 290 L 815 305" stroke="#e91e63" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  <path d="M 500 440 L 815 422" stroke="#2196f3" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  <path d="M 500 590 L 815 537" stroke="#9c27b0" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  
  <!-- Legend -->
  <g id="legend">
    <rect x="820" y="640" width="340" height="200" rx="10" fill="#ffffff" stroke="#bdbdbd" stroke-width="1"/>
    <text x="990" y="665" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#424242">Legend</text>
    
    <line x1="850" y1="680" x2="890" y2="680" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="900" y="685" font-family="Arial" font-size="11" fill="#666">Sequential flow</text>
    
    <line x1="850" y1="700" x2="890" y2="700" stroke="#666" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
    <text x="900" y="705" font-family="Arial" font-size="11" fill="#666">Data storage</text>
    
    <rect x="850" y="720" width="40" height="20" rx="5" fill="#e8f5e9" stroke="#4caf50" stroke-width="1"/>
    <text x="900" y="735" font-family="Arial" font-size="11" fill="#666">Database/Storage</text>
    
    <rect x="850" y="750" width="40" height="20" rx="5" fill="#fff3e0" stroke="#ff9800" stroke-width="1"/>
    <text x="900" y="765" font-family="Arial" font-size="11" fill="#666">Processing step</text>
    
    <rect x="850" y="780" width="40" height="20" rx="5" fill="#f5f5f5" stroke="#9e9e9e" stroke-width="1" stroke-dasharray="3,3"/>
    <text x="900" y="795" font-family="Arial" font-size="11" fill="#666">Supporting module</text>
    
    <rect x="850" y="810" width="40" height="20" rx="5" fill="#fff8e1" stroke="#ffc107" stroke-width="1"/>
    <text x="900" y="825" font-family="Arial" font-size="11" fill="#666">Technology stack</text>
  </g>
</svg>